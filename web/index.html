<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <title>Simulation</title>
    <link rel="icon" type="image/png" href="assets/cube.png" />

    <!-- Fuentes y estilos / Fonts and styles -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="custom.css" />

    <!-- Librerías JS externas / External JS libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/ua-parser-js/dist/ua-parser.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.26.1.min.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>

    <!-- Configuración de Tailwind / Tailwind configuration -->
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["'Source Sans 3'", "ui-sans-serif", "system-ui"],
            },
            colors: {
              lightBg: "#FAFAFA",
            },
          },
        },
      };
    </script>
  </head>

  <body class="bg-lightBg dark:bg-gray-900 text-gray-800 dark:text-gray-200 font-sans transition-colors duration-300">
    <div class="flex flex-col lg:flex-row h-screen">
      <!-- Panel izquierdo / Left panel -->
      <div class="w-full sm:w-full md:w-full lg:w-64 xl:w-68 2xl:w-72 bg-white dark:bg-gray-800 flex flex-col ml-6 my-10 rounded-2xl max-h-[calc(100vh-2.5rem)] border border-gray-200 dark:border-gray-800 shadow-md transition-all duration-300">
        <div class="px-6 pt-6 pb-4 z-20">
          <h2 class="text-2xl font-semibold">Parameters</h2>
        </div>
        <div class="p-3 border-t border-gray-300 dark:border-gray-600 transition-colors duration-300"></div>

        <div class="flex-1 overflow-y-auto px-6 py-2 flex flex-col">
          <label class="block mb-1 text-base">Simulation Method</label>
          <select id="simulation_method" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300">
            <option value="NVT_Langevin_BAOAB">NVT Langevin BAOAB</option>
            <option value="muVT_Monte_Carlo">μVT Monte Carlo</option>
          </select>

          <!-- Inputs para NVT_Langevin_BAOAB / Inputs for NVT_Langevin_BAOAB -->
          <div id="inputs_nvt">
            <label class="block mb-1 text-base">Number of Particles</label>
            <input id="n_particles" oninput="this.value = this.value.replace(/[^0-9]/g, '')" type="text" value="5" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Number of Steps</label>
            <input id="n_steps" oninput="this.value = this.value.replace(/[^0-9]/g, '')" type="text" value="10" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Delta t</label>
            <input id="dt" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="0.005" step="0.001" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Box size</label>
            <input id="box_size" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="10.0" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Cutoff</label>
            <input id="cutoff" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="2.5" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Skin</label>
            <input id="skin" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="0.3" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Seed</label>
            <input id="seed" oninput="this.value = this.value.replace(/[^0-9]/g, '')" type="text" value="12345" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Temperature (kT)</label>
            <input id="kT" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="1.0" step="0.01" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Friction (γ)</label>
            <input id="gamma" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="0.1" step="0.01" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />
          </div>

          <!-- Inputs para μVT Monte Carlo / Inputs for μVT Monte Carlo -->
          <div id="inputs_muvt" class="hidden">
            <label class="block mb-1 text-base">Initial Particles</label>
            <input id="N" oninput="this.value = this.value.replace(/[^0-9]/g, '')" type="text" value="20" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Box Volume</label>
            <input id="V" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="300.0" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Temperature</label>
            <input id="T" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="5.0" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">μ (Chemical Potential)</label>
            <input id="mu" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="0.1" step="0.01" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Number of Steps (Monte Carlo Steps)</label>
            <input id="nsteps" oninput="this.value = this.value.replace(/[^0-9]/g, '')" type="text" value="5000" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Target Displacement (xi_target)</label>
            <input id="xi_target" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="0.5" step="0.01" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Bias Force Constant (k_bias)</label>
            <input id="k_bias" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="5.0" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Gaussian Width (σ_meta):</label>
            <input id="sigma_meta" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="0.1" step="0.01" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />

            <label class="block mb-1 text-base">Gaussian Height (height_meta)</label>
            <input id="height_meta" oninput=" this.value = this.value .replace(/[^0-9.]/g,'') .replace(/(\..*?\.)/g,'.'); if(this.value.startsWith('.')) this.value=''; " type="text" value="1.0" step="0.1" class="w-full p-2 border rounded mb-4 bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 transition-colors duration-300" />
          </div>

          <div class="mt-4 flex flex-col sm:flex-row gap-2">
            <!-- Botón de ejecutar / Run button -->
            <button id="runSimulation" class="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition w-full sm:w-auto">Run Simulation</button>

            <!-- Botón de descarga / Download button -->
            <button id="downloadSimulation" class="bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 transition flex items-center justify-center w-full sm:w-auto">
              <i class="fas fa-download"></i>
            </button>
          </div>
          <div id="message" class="mt-2 text-sm text-gray-600 dark:text-gray-400 min-h-[1.2em] transition-colors duration-300"></div>
        </div>

        <!-- Separador e iconos sociales + toggle modo oscuro / Separator and social icons + dark mode toggle -->
        <div class="p-3 border-t border-gray-300 dark:border-gray-600 transition-colors duration-300">
          <div class="flex justify-center space-x-4 items-center">
            <!-- GitHub -->
            <a href="https://github.com/pgomur" target="_blank" class="text-gray-800 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white transition-colors duration-300">
              <i class="fab fa-github fa-lg"></i>
            </a>

            <!-- Toggle modo oscuro / Dark mode toggle -->
            <button id="dark-toggle" class="text-gray-800 dark:text-gray-200 hover:text-gray-500 transition-colors duration-300 text-lg">
              <i class="fas fa-moon"></i>
            </button>

            <!-- Icono de información / Information icon -->
            <a href="#" id="infoModalTrigger" class="text-gray-800 dark:text-gray-200 hover:text-gray-500 transition-colors duration-300 text-lg">
              <i class="fas fa-info-circle"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- Panel derecho / Right panel -->
      <div class="flex-1 p-6 transition-colors duration-300 flex flex-col mt-3">
        <!-- Row 1 -->
        <div class="flex simulation-nvt flex-1 gap-4 min-h-0 mb-4">
          <div class="flex-[3] mr-4 flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">System Energy Plot</h3>
            <div id="output" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
          <div class="flex-[2] flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">3D Particle Positions</h3>
            <div id="positions3d" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="flex simulation-nvt flex-1 gap-4 min-h-0 mb-4">
          <div class="flex-1 mr-4 flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">System Temperature vs Time</h3>
            <div id="temperature" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
          <div class="flex-1 flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">Pressure vs Time</h3>
            <div id="pressure" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
        </div>
        <!-- Row 1 -->
        <div class="flex simulation-muvt hidden flex-1 gap-4 min-h-0 mb-4">
          <div class="flex-[3] mr-4 flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">Applied Bias Profile on Collective Coordinate</h3>
            <div id="plotMetaBias" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
          <div class="flex-[2] flex flex-col min-h-0">
            <h3 id="plotTitle" class="text-lg font-semibold mb-2">3D Particle Distribution</h3>
            <div id="plotParticles3D" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="flex simulation-muvt hidden flex-1 gap-4 min-h-0 mb-4">
          <div class="flex-1 mr-4 flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">2D Projection</h3>
            <div id="plotProjection2D" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
          <div class="flex-1 flex flex-col min-h-0">
            <h3 class="text-lg font-semibold mb-2">Collective Variable Occupancy Histogram</h3>
            <div id="plotCVHistogram" class="w-full flex-1 min-h-0 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-md overflow-hidden transition-colors duration-300"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de información con tabs y contenido / Information modal with tabs and content -->
    <div id="modalContainer"></div>

    <!-- Toda la lógica en script.js / All logic in script.js -->
    <script type="module" src="script.js"></script>
  </body>
</html>
